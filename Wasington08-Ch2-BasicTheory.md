### 有限域

有限域是定义了加减乘除 (不包括除 0) 的有限集合. 其加减乘除需满足域公理 (field axioms).
有限域的**阶(order)**, 就是元素的个数.

$q$ 阶有限域存在, 当且仅当 $q=p^k$, 其中 $p$ 是质数, $k$ 是正整数. 在 $p^k$ 阶有限域里, 把 $p$ 个任意元素加起来总能得到 0. 这个质数 $p$ 称为有限域的 characteristics.

### 无穷点

无穷点 $\infty$ 被定义为是**椭圆曲线上**的特殊点. 一条直线经过无穷点, 当且仅当其与 $x$ 轴垂直.

同时, 无穷点在点的加法里有类似于 0 的性质.

### 椭圆曲线的 Weistrass 形式

$$
y^2 = x^3 + Ax + B
$$

这里

- $A, B$ 的通常是某个域 (field) $K$​ 的元素;
- $x, y$ 也是某个域 $L$ 的元素, 且有 $L\supseteq K$ .

椭圆曲线上的点的集合, 定义为

$$
E(L)=\left\{\infty\right\}\cup\left\{(x,y)\in L\times L~\vert~ y^2 = x^3 + Ax + B\right\}
$$

### 椭圆曲线上的点的加法

定义: 设两点 $P_1, P_2$ 在椭圆曲线上, 经过这两点的直线 $L$ 与椭圆曲线交于第三点 $P_3^\prime$ . $P_3^\prime$ 关于 $x$ 轴的对称点为 $P_3$ . 称 $P_3=P_1+P_2$ .

(一) **异点相加.** 当 $x_1\neq x_2$ 时, 直接执行定义.

注意: 一元三次方程 $ax^3 + bx^2 + cx + d = 0$ , 三个根满足 $x_1+x_2+x_3 = -\dfrac{b}{a}$​​ . 利用这个技巧快速地求交点.

结论:

$$
x_3 = m^2 - x_1 - x_2,\hspace{2em}y_3=m(x_1-x_3)-y_1
$$

其中 $m$ 是直线的斜率, 即 $m=\dfrac{y_2-y_1}{x_2-x_1}$ .

(二) **点倍增.** 当 $x_1=x_2$ 且 $y_1 = y_2$ 时, 经过两点的直线为曲线在该点的切线.

注意: (1/2) 利用隐函数求导的技巧得到切线斜率. (2/2) 直线方程代入曲线方程后, 视为有两个重根.

结论:

$$
x_3=m^2-2x_1,\hspace{2em}y_3=m(x_1-x_3)-y_1
$$

其中 $m$ 是直线的斜率, 即 $m=\dfrac{3x_1^2+A}{2y_1}$ .

(三) **零点倍增**. 当 $x_1=x_2$ 且 $y_1=0$ 时, 倍增得到 $\infty$ . 可以说, 零点是自己的加法逆元.

(四) **共轭点相加.** 当 $x_1=x_2$ 且 $y_1\neq y_2$ 时, 相加得到 $\infty$​ . 共轭点之间互为加法逆元.

$E$ 上点的加法满足:

(1) **交换律.** 对 $E$ 上任意两点 $P_1, P_2$ , 有 $P_1+P_2 = P_2+P_1$ ;

(2) **存在单位元 $\infty$.** 对 $E$ 上任意点 $P$, 有 $P+\infty = P$ ;

(3) **普遍地存在逆元.** 对 $E$ 上任一点 $P$ , 存在 $E$ 上点 $P^\prime$ , 使得 $P+P^\prime=\infty$ . 通常把 $P^\prime$ 记为 $-P$ .

(4) **结合律.** 对 $E$ 上任意三点 $P_1, P_2, P_3$, 有 $(P_1+P_2)+P_3 = P_1+(P_2+P_3)$ .

前三条是显然的. 第四条证明较为复杂, 详见 «Elliptic Curves - Number Theory and Cryptography (2nd edition)» (Washington, 2008) 的 2.4 节

有了点相加的定义, 可以继续定义点的整数数乘 -- 加法的重复. 其计算是一个「迭代倍增」的过程.

给出 $P$ 和 $kP$, 很难求出 $k$. 这个难题叫「离散对数问题 (discrete logarithm problem)」.
